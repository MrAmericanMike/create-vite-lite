#!/usr/bin/env node
import r from"node:fs";import s from"node:path";import{fileURLToPath as y}from"node:url";import d from"prompts";import{blue as o,bold as u,red as c,reset as f,yellow as t,magenta as v,cyan as g,green as S}from"kolorist";const h=[{name:"vanilla",display:"Vanilla",color:t,flavors:[{name:"template-vanilla-js",display:"JavaScript",color:t},{name:"template-vanilla-ts",display:"TypeScript",color:o}]},{name:"lit",display:"Lit",color:o,flavors:[{name:"template-lit-js",display:"JavaScript",color:t},{name:"template-lit-ts",display:"TypeScript",color:o}]},{name:"preact",display:"Preact",color:v,flavors:[{name:"template-preact-js",display:"JavaScript",color:t},{name:"template-preact-ts",display:"TypeScript",color:o}]},{name:"react",display:"React",color:g,flavors:[{name:"template-react-js",display:"JavaScript",color:t},{name:"template-react-ts",display:"TypeScript",color:o}]},{name:"svelte",display:"Svelte",color:c,flavors:[{name:"template-svelte-js",display:"JavaScript",color:t},{name:"template-svelte-ts",display:"TypeScript",color:o}]},{name:"vue",display:"Vue",color:S,flavors:[{name:"template-vue-js",display:"JavaScript",color:t},{name:"template-vue-ts",display:"TypeScript",color:o}]}];async function w(){if(console.log(o("Create-Vite-Lite")),console.log(u(o("This package is still in beta. Bugs included at no extra charge!"))),T("."))try{const e=await k();console.log(`${e.framework.display} ${e.flavor.display}`);const a=s.resolve(y(import.meta.url),"../..",e.flavor.name),l=r.readdirSync(a);for(const n of l)L(a,n);b()}catch(e){console.log(e)}else return console.log(`\u274C ${c("You can only use this script within an empty folder")} \u274C`)}async function k(){return await d([{type:"select",name:"framework",message:"Pick a framework",choices:h.map(e=>({title:e.color(e.display),value:e}))},{type:e=>e&&e.flavors?"select":null,name:"flavor",message:f("Select a flavor:"),choices:e=>e.flavors.map(a=>{const l=a.color;return{title:l(a.display),value:{name:a.name,display:a.display}}})}],{onCancel:()=>{console.log("\u274C Cancelled"),process.exit(0)}})}function C(e){return{_gitignore:".gitignore"}[e]??e}function T(e){try{const a=r.readdirSync(e);return a.length===0||a.length===1&&a[0]===".git"}catch(a){return console.log(a),!1}}function j(){const e=process?.env?.npm_config_user_agent||null;if(!e)return null;const a=e.split(" ")[0],[l,n]=a.split("/");return{name:l,version:n}}function L(e,a){const l=C(a);i(s.join(e,a),l)}function i(e,a){r.statSync(e).isDirectory()?$(e,a):r.copyFileSync(e,a)}function $(e,a){r.mkdirSync(a,{recursive:!0});const l=r.readdirSync(e);for(const n of l){const p=s.resolve(e,n),m=s.resolve(a,n);i(p,m)}}function b(){console.log(`${o("All done")} \xB7 ${c("Update package.json accordingly")}`);const e=j();if(e?.name)switch(e?.name.toLowerCase()){case"yarn":console.log("  yarn"),console.log("  yarn dev");break;default:console.log(`  ${e?.name.toLowerCase()} install`),console.log(`  ${e?.name.toLowerCase()} run dev`);break}else console.log("  install dependencies"),console.log("  run dev script")}w();
